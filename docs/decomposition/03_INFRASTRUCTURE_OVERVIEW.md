# 03 - ĞĞ±Ğ·Ğ¾Ñ€ Ğ¸Ğ½Ñ„Ñ€Ğ°ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹

**ĞŸÑ€ĞµĞ´Ñ‹Ğ´ÑƒÑ‰Ğ¸Ğ¹:** [02_DECOMPOSITION_STRATEGY.md](02_DECOMPOSITION_STRATEGY.md)  
**Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹:** [04_DOCKER_SETUP.md](04_DOCKER_SETUP.md)

---

## ğŸ—ï¸ ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹ Ğ¸Ğ½Ñ„Ñ€Ğ°ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ñ‹

### ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ½Ğ°Ñ Ğ´Ğ¸Ğ°Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    API Gateway :8080                     â”‚
â”‚              (Spring Cloud Gateway)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚            â”‚            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Eureka :8761 â”‚ â”‚Config:8888â”‚ â”‚Zipkin:9411 â”‚
â”‚   (Service   â”‚ â”‚  (Config  â”‚ â”‚ (Tracing)  â”‚
â”‚  Discovery)  â”‚ â”‚  Server)  â”‚ â”‚            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Message Broker Layer                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Kafka :9092  â”‚  Zookeeper :2181  â”‚  Redis :6379       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Database Layer                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  MongoDB-Logging :27017  â”‚  MongoDB-Analytics :27018   â”‚
â”‚  PostgreSQL :5432        â”‚  InfluxDB :8086             â”‚
â”‚  MinIO :9000/9001                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Monitoring Layer                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Prometheus :9090  â”‚  Grafana :3000  â”‚  Kafka-UI :8090 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ¾Ğ²

### Service Mesh

| ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚ | ĞŸĞ¾Ñ€Ñ‚ | ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ | ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚ |
|-----------|------|------------|-----------|
| **API Gateway** | 8080 | Ğ•Ğ´Ğ¸Ğ½Ğ°Ñ Ñ‚Ğ¾Ñ‡ĞºĞ° Ğ²Ñ…Ğ¾Ğ´Ğ° | ğŸ”´ ĞšÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ |
| **Eureka Server** | 8761 | Service Discovery | ğŸ”´ ĞšÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ |
| **Config Server** | 8888 | Ğ¦ĞµĞ½Ñ‚Ñ€Ğ°Ğ»Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ°Ñ ĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ | ğŸ”´ ĞšÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ |
| **Zipkin** | 9411 | Distributed Tracing | ğŸŸ¡ Ğ’Ğ°Ğ¶Ğ½Ñ‹Ğ¹ |

### Message Broker

| ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚ | ĞŸĞ¾Ñ€Ñ‚ | ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ | ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚ |
|-----------|------|------------|-----------|
| **Apache Kafka** | 9092 | Event Streaming | ğŸ”´ ĞšÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ |
| **Zookeeper** | 2181 | Kafka Coordination | ğŸ”´ ĞšÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ |
| **Redis** | 6379 | Distributed Cache | ğŸŸ¡ Ğ’Ğ°Ğ¶Ğ½Ñ‹Ğ¹ |
| **Kafka UI** | 8090 | Kafka Management | ğŸŸ¢ ĞĞ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ |

### Databases

| ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚ | ĞŸĞ¾Ñ€Ñ‚ | ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ | ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚ |
|-----------|------|------------|-----------|
| **MongoDB (Logging)** | 27017 | Ğ›Ğ¾Ğ³Ğ¸ Ğ¸ audit trail | ğŸ”´ ĞšÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ |
| **MongoDB (Analytics)** | 27018 | ĞĞ½Ğ°Ğ»Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ | ğŸŸ¡ Ğ’Ğ°Ğ¶Ğ½Ñ‹Ğ¹ |
| **PostgreSQL** | 5432 | ĞÑĞ½Ğ¾Ğ²Ğ½Ğ°Ñ Ğ‘Ğ” | ğŸ”´ ĞšÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ |
| **InfluxDB** | 8086 | Time-series Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸ | ğŸŸ¡ Ğ’Ğ°Ğ¶Ğ½Ñ‹Ğ¹ |
| **MinIO** | 9000/9001 | Object Storage (Ğ±ÑĞºĞ°Ğ¿Ñ‹) | ğŸŸ¡ Ğ’Ğ°Ğ¶Ğ½Ñ‹Ğ¹ |

### Monitoring

| ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚ | ĞŸĞ¾Ñ€Ñ‚ | ĞĞ°Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ | ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚ |
|-----------|------|------------|-----------|
| **Prometheus** | 9090 | Metrics Collection | ğŸŸ¡ Ğ’Ğ°Ğ¶Ğ½Ñ‹Ğ¹ |
| **Grafana** | 3000 | Visualization | ğŸŸ¡ Ğ’Ğ°Ğ¶Ğ½Ñ‹Ğ¹ |

---

## ğŸ”„ ĞŸĞ¾Ñ€ÑĞ´Ğ¾Ğº Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°

### Ğ¨Ğ°Ğ³ 1: Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğµ ÑĞµÑ€Ğ²Ğ¸ÑÑ‹

```bash
docker-compose up -d zookeeper kafka redis
```

**ĞĞ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ğµ:** 30-60 ÑĞµĞºÑƒĞ½Ğ´

### Ğ¨Ğ°Ğ³ 2: Databases

```bash
docker-compose up -d mongodb-logging mongodb-analytics postgresql influxdb minio
```

**ĞĞ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ğµ:** 30-60 ÑĞµĞºÑƒĞ½Ğ´

### Ğ¨Ğ°Ğ³ 3: Service Discovery

```bash
docker-compose up -d eureka-server
```

**ĞĞ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ğµ:** 30-60 ÑĞµĞºÑƒĞ½Ğ´  
**ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ°:** http://localhost:8761

### Ğ¨Ğ°Ğ³ 4: Config Server

```bash
docker-compose up -d config-server
```

**ĞĞ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ğµ:** 30-60 ÑĞµĞºÑƒĞ½Ğ´  
**ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ°:** http://localhost:8888/actuator/health

### Ğ¨Ğ°Ğ³ 5: API Gateway

```bash
docker-compose up -d api-gateway
```

**ĞĞ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ğµ:** 30-60 ÑĞµĞºÑƒĞ½Ğ´  
**ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ°:** http://localhost:8080/actuator/health

### Ğ¨Ğ°Ğ³ 6: Monitoring

```bash
docker-compose up -d prometheus grafana zipkin kafka-ui
```

**ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ°:**
- Prometheus: http://localhost:9090
- Grafana: http://localhost:3000 (admin/admin)
- Zipkin: http://localhost:9411
- Kafka UI: http://localhost:8090

---

## ğŸ” Health Checks

### ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ²ÑĞµÑ… ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ²

```bash
# Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ Ğ²ÑĞµÑ… ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ¾Ğ²
docker-compose ps

# Ğ›Ğ¾Ğ³Ğ¸ ĞºĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ğ¾Ğ³Ğ¾ ÑĞµÑ€Ğ²Ğ¸ÑĞ°
docker-compose logs -f eureka-server

# Health check Ğ²ÑĞµÑ… ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ²
curl http://localhost:8761/actuator/health
curl http://localhost:8888/actuator/health
curl http://localhost:8080/actuator/health
```

### ĞĞ¶Ğ¸Ğ´Ğ°ĞµĞ¼Ñ‹Ğµ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ñ‹

```json
{
  "status": "UP",
  "components": {
    "diskSpace": {"status": "UP"},
    "ping": {"status": "UP"}
  }
}
```

---

## ğŸ“Š Ğ¢Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğº Ñ€ĞµÑÑƒÑ€ÑĞ°Ğ¼

### Development Environment

| ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚ | CPU | RAM | Disk |
|-----------|-----|-----|------|
| Kafka + Zookeeper | 1 core | 2 GB | 10 GB |
| MongoDB (x2) | 0.5 core | 1 GB | 20 GB |
| PostgreSQL | 0.5 core | 512 MB | 10 GB |
| InfluxDB | 0.5 core | 512 MB | 5 GB |
| MinIO | 0.5 core | 512 MB | 50 GB |
| Eureka | 0.5 core | 512 MB | 1 GB |
| Config Server | 0.5 core | 512 MB | 1 GB |
| API Gateway | 0.5 core | 512 MB | 1 GB |
| Redis | 0.5 core | 256 MB | 1 GB |
| Monitoring | 1 core | 2 GB | 5 GB |
| **Ğ˜Ğ¢ĞĞ“Ğ** | **6-8 cores** | **8-10 GB** | **104 GB** |

### Production Environment

- CPU: 16-32 cores
- RAM: 32-64 GB
- Disk: 500 GB - 1 TB (SSD)
- Network: 1 Gbps+

---

## ğŸ” Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ

### Credentials (Development)

```yaml
# MongoDB
Username: admin
Password: admin_password

# PostgreSQL
Username: postgres
Password: postgres_password

# Redis
Password: redis_password

# MinIO
Access Key: minioadmin
Secret Key: minioadmin

# Grafana
Username: admin
Password: admin
```

âš ï¸ **Ğ’ĞĞ–ĞĞ:** Ğ’ production Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ ÑĞ¸Ğ»ÑŒĞ½Ñ‹Ğµ Ğ¿Ğ°Ñ€Ğ¾Ğ»Ğ¸ Ğ¸ Ñ…Ñ€Ğ°Ğ½Ğ¸Ñ‚Ğµ Ğ¸Ñ… Ğ² secrets!

---

## ğŸŒ Network Configuration

### Docker Network

```yaml
networks:
  microservices-network:
    driver: bridge
```

### Service Communication

```
Ğ’Ğ½ÑƒÑ‚Ñ€Ğ¸ Docker:
  kafka:9092
  mongodb-logging:27017
  eureka-server:8761

Ğ¡Ğ½Ğ°Ñ€ÑƒĞ¶Ğ¸ Docker:
  localhost:9092
  localhost:27017
  localhost:8761
```

---

## ğŸ“ Volumes

### Persistent Data

```yaml
volumes:
  kafka-data:           # Kafka messages
  mongodb-logging-data: # Logs
  mongodb-analytics-data: # Analytics
  postgresql-data:      # Core business data
  influxdb-data:        # Metrics
  minio-data:           # Backups
  redis-data:           # Cache
  prometheus-data:      # Prometheus metrics
  grafana-data:         # Grafana dashboards
```

### Backup Strategy

```bash
# Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ±ÑĞºĞ°Ğ¿Ğ° Ğ²ÑĞµÑ… volumes
docker-compose down
tar -czf volumes-backup.tar.gz /var/lib/docker/volumes/

# Ğ’Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ
tar -xzf volumes-backup.tar.gz -C /
docker-compose up -d
```

---

## âœ… ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ³Ğ¾Ñ‚Ğ¾Ğ²Ğ½Ğ¾ÑÑ‚Ğ¸

### Ğ§ĞµĞºĞ»Ğ¸ÑÑ‚

- [ ] Ğ’ÑĞµ ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ñ‹ Ğ·Ğ°Ğ¿ÑƒÑ‰ĞµĞ½Ñ‹ (`docker-compose ps`)
- [ ] Eureka Ğ¿Ğ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ·Ğ°Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ ÑĞµÑ€Ğ²Ğ¸ÑÑ‹
- [ ] Config Server Ğ¾Ñ‚Ğ²ĞµÑ‡Ğ°ĞµÑ‚ Ğ½Ğ° Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹
- [ ] API Gateway Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½
- [ ] Kafka topics ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ñ‹
- [ ] MongoDB Ğ¿Ñ€Ğ¸Ğ½Ğ¸Ğ¼Ğ°ĞµÑ‚ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ
- [ ] PostgreSQL Ğ¿Ñ€Ğ¸Ğ½Ğ¸Ğ¼Ğ°ĞµÑ‚ Ğ¿Ğ¾Ğ´ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ
- [ ] Prometheus ÑĞ¾Ğ±Ğ¸Ñ€Ğ°ĞµÑ‚ Ğ¼ĞµÑ‚Ñ€Ğ¸ĞºĞ¸
- [ ] Grafana Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ°
- [ ] Zipkin Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½

---

**Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ ÑˆĞ°Ğ³:** [04_DOCKER_SETUP.md](04_DOCKER_SETUP.md)
